<!doctype html>
<html>
<head>
	<title>杭州</title>
	<style type="text/css">
		html, body, img {
			padding: 0;
			margin: 0;
			width: 100%;
			height: 100%;
		}
		body {
			background: url();
		}
	</style>
</head>
<body>
<img id="img">
<script type="text/javascript">
var Count = 800;
var xhr = new XMLHttpRequest;
window.List = [];
var loaded = 0;
var running = false;
var run = function(){
	running = true;
	el = document.getElementById('img');
	List.reverse();
	List.forEach(function(img, key){
		setTimeout(function(){
			el.src = img.src;
		}, key * 120);
	});
}
xhr.open("GET","http://photo.weibo.com/photos/get_all?uid=3329924902&album_id=3572827348456361&count=" + Count + "&page=1&type=3")
xhr.onloadend = function(ev){
	var obj = JSON.parse(xhr.responseText); 
	var data = obj.data.photo_list; 
	var loadFunc = function(){
		loaded++;
		percent = Math.round(loaded / Count); 
		document.title = percent + "%";
		if(percent > 0.9) {
			if(!running) run()
		}

	}
	data.map(function(item,key){
		if(item && item.pic_host) 
			List[key] = new Image()
			List[Key].onload = loadFunc;
			List[key].src=item.pic_host+"/large/"+item.pic_name;
	})}
xhr.send()

</script>
</body>
</html>


